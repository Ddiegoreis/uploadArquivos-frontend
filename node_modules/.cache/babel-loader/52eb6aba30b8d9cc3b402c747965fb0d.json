{"ast":null,"code":"var _jsxFileName = \"/home/diego/Documentos/www/uploadArquivos/frontend/src/App.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { uniqueId } from 'lodash';\nimport FileSize from 'filesize';\nimport api from './services/api';\nimport GlobalStyles from './styles/global';\nimport { Container, Content } from './styles';\nimport Upload from './components/Upload';\nimport FileList from './components/FileList';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [uploadedFiles, setUploadedFiles] = useState([]);\n\n  const handleUpload = files => {\n    const uploadedFile = files.map(file => ({\n      file,\n      id: uniqueId(),\n      name: file.name,\n      readableSize: FileSize(file.size),\n      preview: URL.createObjectURL(file),\n      progress: 0,\n      uploaded: false,\n      error: false,\n      url: null\n    }));\n    setUploadedFiles(uploadedFiles.concat(uploadedFile));\n  };\n\n  useEffect(() => {\n    const notUuploaded = uploadedFiles.filter(file => !file.uploaded);\n    notUuploaded.forEach(processUpload);\n  }, [uploadedFiles]);\n\n  const processUpload = uploadedFile => {\n    const data = new FormData();\n    data.append('file', uploadedFile.file, uploadedFile.name);\n    api.post('posts', data, {\n      onUploadProgress: e => {\n        const progress = parseInt(Math.round(e.loaded * 100 / e.total));\n        updateFile(uploadedFile.id, {\n          progress\n        });\n      }\n    }).then(response => {\n      updateFile(uploadedFile.id, {\n        uploaded: true,\n        id: response.data._id,\n        url: response.data.url\n      });\n    }).catch(() => {\n      updateFile(uploadedFile.id, {\n        error: true\n      });\n    });\n  }; // const updateFile = (id, data) => {\n  // \tsetUploadedFiles({\n  // \t\tuploadedFile: uploadedFiles.map((file) => {\n  // \t\t\treturn id === file.id\n  // \t\t\t\t? { ...file, ...data }\n  // \t\t\t\t: file\n  // \t\t}),\n  // \t})\n  // }\n\n\n  const handleDelete = async id => {\n    await api.delete(`posts/${id}`);\n    setUploadedFiles({\n      uploadedFile: uploadedFiles.filter(file => file.id !== id)\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(Content, {\n      children: [/*#__PURE__*/_jsxDEV(Upload, {\n        onUpload: handleUpload\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 5\n      }, this), !!uploadedFiles.length && /*#__PURE__*/_jsxDEV(FileList, {\n        files: uploadedFiles\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(GlobalStyles, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 3\n  }, this);\n}\n\n_s(App, \"YG97OoBp6FgVaJGhZUBlSGbkEW4=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/home/diego/Documentos/www/uploadArquivos/frontend/src/App.js"],"names":["useState","useEffect","uniqueId","FileSize","api","GlobalStyles","Container","Content","Upload","FileList","App","uploadedFiles","setUploadedFiles","handleUpload","files","uploadedFile","map","file","id","name","readableSize","size","preview","URL","createObjectURL","progress","uploaded","error","url","concat","notUuploaded","filter","forEach","processUpload","data","FormData","append","post","onUploadProgress","e","parseInt","Math","round","loaded","total","updateFile","then","response","_id","catch","handleDelete","delete","length"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport { uniqueId } from 'lodash'\nimport FileSize from 'filesize'\n\nimport api from './services/api'\n\nimport GlobalStyles from './styles/global'\nimport { Container, Content } from './styles'\n\nimport Upload from './components/Upload'\nimport FileList from './components/FileList'\n\nfunction App() {\n\tconst [uploadedFiles, setUploadedFiles] = useState([])\n\n\tconst handleUpload = (files) => {\n\t\tconst uploadedFile = files.map((file) => ({\n\t\t\tfile,\n\t\t\tid: uniqueId(),\n\t\t\tname: file.name,\n\t\t\treadableSize: FileSize(file.size),\n\t\t\tpreview: URL.createObjectURL(file),\n\t\t\tprogress: 0,\n\t\t\tuploaded: false,\n\t\t\terror: false,\n\t\t\turl: null,\n\t\t}))\n\n\t\tsetUploadedFiles(uploadedFiles.concat(uploadedFile))\n\t}\n\n\tuseEffect(() => {\n\t\tconst notUuploaded = uploadedFiles.filter(\n\t\t\t(file) => !file.uploaded\n\t\t)\n\n\t\tnotUuploaded.forEach(processUpload)\n\t}, [uploadedFiles])\n\n\tconst processUpload = (uploadedFile) => {\n\t\tconst data = new FormData()\n\n\t\tdata.append('file', uploadedFile.file, uploadedFile.name)\n\n\t\tapi.post('posts', data, {\n\t\t\tonUploadProgress: (e) => {\n\t\t\t\tconst progress = parseInt(\n\t\t\t\t\tMath.round((e.loaded * 100) / e.total)\n\t\t\t\t)\n\n\t\t\t\tupdateFile(uploadedFile.id, {\n\t\t\t\t\tprogress,\n\t\t\t\t})\n\t\t\t},\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tupdateFile(uploadedFile.id, {\n\t\t\t\t\tuploaded: true,\n\t\t\t\t\tid: response.data._id,\n\t\t\t\t\turl: response.data.url,\n\t\t\t\t})\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tupdateFile(uploadedFile.id, {\n\t\t\t\t\terror: true,\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\t// const updateFile = (id, data) => {\n\t// \tsetUploadedFiles({\n\t// \t\tuploadedFile: uploadedFiles.map((file) => {\n\t// \t\t\treturn id === file.id\n\t// \t\t\t\t? { ...file, ...data }\n\t// \t\t\t\t: file\n\t// \t\t}),\n\t// \t})\n\t// }\n\n\tconst handleDelete = async (id) => {\n\t\tawait api.delete(`posts/${id}`)\n\n\t\tsetUploadedFiles({\n\t\t\tuploadedFile: uploadedFiles.filter(\n\t\t\t\t(file) => file.id !== id\n\t\t\t),\n\t\t})\n\t}\n\n\treturn (\n\t\t<Container>\n\t\t\t<Content>\n\t\t\t\t<Upload onUpload={handleUpload} />\n\t\t\t\t{!!uploadedFiles.length && (\n\t\t\t\t\t<FileList files={uploadedFiles} />\n\t\t\t\t)}\n\t\t\t</Content>\n\t\t\t<GlobalStyles />\n\t\t</Container>\n\t)\n}\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}